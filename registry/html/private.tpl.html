<!DOCTYPE html>

<head>
    <title>Pagina di @MATRICOLA@</title>
    <meta charset="utf-8" />

    <style>
        body{
            font-family: Verdana, Geneva, sans-serif;
        }
        .line {
            display: inline-block;
        }
    </style>
</head>

<body>
    <h2>Ciao @NOME@ @COGNOME@! - <a href="/logout">Logout</a></h2>
    <p>Questa e' la tua pagina personale, in cui puoi gestire i tuoi dati.</p>

    <h3>Dati personali</h3>

    <div id="Name">
        <div id="preName" class="line"><b>Nome</b>:&nbsp;</div>
        <div id="zoneName" class="line">@NOME@</div>
        <div id="postName" class="line">&nbsp;<button onclick='openForm("postName","Name","name","23")'>Modifica</button></div>
    </div>
    <div id="infoName"></div>
    <br />

    <div id="Surname">
        <div id="preSurname" class="line"><b>Cognome</b>:&nbsp;</div>
        <div id="zoneSurname" class="line">@COGNOME@</div>
        <div id="postSurname" class="line">&nbsp;<button onclick='openForm("postSurname","Surname","surname","23")'>Modifica</button></div>
    </div>
    <div id="infoSurname"></div>
    <br />

    <b>Matricola</b>: @MATRICOLA@
    <br /><br />

    <h3>Dati funzionali al corso</h3>

    <div id="UrlBlog">
        <div id="preBlog" class="line"><b>Url blog</b>:&nbsp;</div>
        <div id="zoneBlog" class="line">@BLOG@</div>
        <div id="postBlog" class="line">&nbsp;<button onclick='openForm("postBlog","UrlBlog","blog","42")'>Modifica</button></div>
        <div id="exBlog" class="line"><small>&nbsp;es. http://www.example.com</small></div>
    </div>
    <div id="infoBlog"></div>
    <br />

    <div id="AccountTwitter">
        <div id="preTwitter" class="line"><b>Account Twitter</b>:&nbsp;</div>
        <div id="zoneTwitter" class="line">@TWITTER@</div>
        <div id="postTwitter" class="line">&nbsp;<button onclick='openForm("postTwitter","AccountTwitter","twitter","20")'>Modifica</button></div>
        <div id="exTwitter" class="line"><small>&nbsp;es. @NickTwitter</small></div>
    </div>
    <div id="infoTwitter"></div>
    <br />

    <div id="AccountWP">
        <div id="preWP" class="line"><b>Account Wikipedia</b>:&nbsp;</div>
        <div id="zoneWP" class="line">@WIKIPEDIA@</div>
        <div id="postWP" class="line">&nbsp;<button onclick='openForm("postWP","AccountWP","wp","30")'>Modifica</button></div>
        <div id="exWikipedia" class="line"><small>&nbsp;es. Utente:MioNickname</small></div>
    </div>
    <div id="infoWP"></div>
    <br />

    <p>I link relativi a video e post verranno utilizzati per accedere agli elaborati per la valutazione. Variazioni degli stessi in data successiva a quelle di consegna (esposte in <a href="http://rivoluzionedigitale.polito.it/regole">regole</a>) verranno normalmente salvate ma ignorate ai fini della correzione.</p>
    <p>I post non vengono salvati ogni volta che aggiornate questa pagina, ma
       possono essere salvati prima della scadenza e vengono in ogni caso
       comunque salvati (molto poco) dopo la scadenza. Di conseguenza, non
       preoccupatevi se, prima della scadenza, i link al vostro post
       fanno riferimento a una versione precedente del post stesso.</p>
    <br>

    <div id="UrlVideo">
        <div id="preVideo" class="line"><b>Url video presentazione</b>:&nbsp;</div>
        <div id="zoneVideo" class="line">@VIDEO@</div>
        <div id="postVideo" class="line">&nbsp;<button onclick='openForm("postVideo","UrlVideo","video","42")'>Modifica</button></div>
        <div id="exVideo" class="line"><small>&nbsp;es. https://www.youtube.com/watch?v=aui6NoM56_k</small></div>
    </div>
    <div id="infoVideo"></div>
    <br />

    <div id="Post1">
        <div id="prePost1" class="line"><b>Post n°1</b>:&nbsp;</div>
        <div id="zonePost1" class="line">@POST1@</div>
        <div id="postPost1" class="line">&nbsp;<button onclick='openForm("postPost1","Post1","post1","42")'>Modifica</button></div>
        <div id="exPost1" class="line"><small>&nbsp;es. http://mioblog.tumblr.com/primo-post</small></div>
    </div>
    <div id="infoPost1"></div>
    <div id="linkPost1">
        <a href="http://highgarden.polito.it/post/annotate/@MATRICOLA@/1" target="_blank">[vedi annotazioni]</a>
        <a href="http://highgarden.polito.it/post/read/@MATRICOLA@/1" target="_blank">[leggi originale]</a>
        <a href="http://highgarden.polito.it/post/view-source/@MATRICOLA@/1" target="_blank">[vedi-sorgente]</a>
    </div>
    <br />

    <div id="Post2">
        <div id="prePost2" class="line"><b>Post n°2</b>:&nbsp;</div>
        <div id="zonePost2" class="line">@POST2@</div>
        <div id="postPost2" class="line">&nbsp;<button onclick='openForm("postPost2","Post2","post2","42")'>Modifica</button></div>
        <div id="exPost2" class="line"><small>&nbsp;es. http://mioblog.tumblr.com/secondo-post</small></div>
    </div>
    <div id="infoPost2"></div>
    <div id="linkPost2">
        <a href="http://highgarden.polito.it/post/annotate/@MATRICOLA@/2" target="_blank">[vedi annotazioni]</a>
        <a href="http://highgarden.polito.it/post/read/@MATRICOLA@/2" target="_blank">[leggi originale]</a>
        <a href="http://highgarden.polito.it/post/view-source/@MATRICOLA@/2" target="_blank">[vedi-sorgente]</a>
    </div>
    <br />

    <div id="Post3">
        <div id="prePost3" class="line"><b>Post n°3</b>:&nbsp;</div>
        <div id="zonePost3" class="line">@POST3@</div>
        <div id="postPost3" class="line">&nbsp;<button onclick='openForm("postPost3","Post3","post3","42")'>Modifica</button></div>
        <div id="exPost3" class="line"><small>&nbsp;es. http://mioblog.tumblr.com/terzo-post</small></div>
    </div>
    <div id="infoPost3"></div>
    <div id="linkPost3">
        <a href="http://highgarden.polito.it/post/annotate/@MATRICOLA@/3" target="_blank">[vedi annotazioni]</a>
        <a href="http://highgarden.polito.it/post/read/@MATRICOLA@/3" target="_blank">[leggi originale]</a>
        <a href="http://highgarden.polito.it/post/view-source/@MATRICOLA@/3" target="_blank">[vedi-sorgente]</a>
    </div>
    <br />
    <br />

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>

    <script type="text/javascript">
        var URL = "^http(|s)://.*$";
        var regexp = {
            "Name": "^[A-Za-z\\\'\\-\\s]+$",
            "Surname": "^[A-Za-z\\\'\\-\\s]+$",
            "UrlBlog": URL,
            "AccountTwitter": "^(|@[A-Za-z0-9_]{1,15})$",
            "AccountWP": "^(U|u)tente:[^\\{\\}\\[\\]\\#\\|\\<]+)$",
            "UrlVideo": URL,
            "Post1": URL,
            "Post2": URL,
            "Post3": URL
        };

        if ($("#zoneBlog").is(":empty")) {
            document.getElementById("zoneBlog").innerHTML = "Url blog non presente.";
        }
        if ($("#zoneTwitter").is(":empty")) {
            document.getElementById("zoneTwitter").innerHTML = "Account Twitter non presente.";
        }
        if ($("#zoneWP").is(":empty")) {
            document.getElementById("zoneWP").innerHTML = "Account Wikipedia non presente.";
        }
        if ($("#zoneVideo").is(":empty")) {
            document.getElementById("zoneVideo").innerHTML = "Url video non presente.";
        }
        if ((document.getElementById("zonePost1").innerHTML === "undefined") || ($("#zonePost1").is(":empty"))) {
            document.getElementById("zonePost1").innerHTML = "Url del primo post non presente.";
        }
        if ((document.getElementById("zonePost2").innerHTML === "undefined") || ($("#zonePost2").is(":empty"))){
            document.getElementById("zonePost2").innerHTML = "Url del secondo post non presente.";
        }
        if ((document.getElementById("zonePost3").innerHTML === "undefined") || ($("#zonePost3").is(":empty"))){
            document.getElementById("zonePost3").innerHTML = "Url del terzo post non presente.";
        }
        function cancelForm(zone,id,nameid,num) {
            document.getElementById(zone).innerHTML =
                '&nbsp;<button onclick=\'openForm(\"'+zone+'\",\"'+id+'\",\"'+nameid+'\",\"'+num+'\")\'>Modifica</button>';
        }
        function openForm(zone,id,nameid,num) {
            document.getElementById(zone).innerHTML =
                '<form id=' + id + ' method="post">&nbsp;<input type="text" name=' + nameid + ' id=' + nameid + ' pattern=' + regexp[id] + ' size=' + num + ' required>&nbsp;<button onclick=\'cancelForm(\"' + zone + '\",\"' + id + '\",\"' + nameid + '\",\"' + num + '\")\'> Annulla </button>&nbsp;<input type="submit" value="Modifica"></form >';
        }
    </script>

    <script type="text/javascript">
        $("#AccountWP").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var wikipedia = $("#wp").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Wikipedia: wikipedia
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zoneWP").text(data.Wikipedia);
                    $("#infoWP").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoWP").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });


        $("#UrlBlog").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var blog = $("#blog").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Blog: blog
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zoneBlog").text(data.Blog);
                    $("#infoBlog").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoBlog").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });


        $("#AccountTwitter").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var twitter = $("#twitter").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Twitter: twitter
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zoneTwitter").text(data.Twitter);
                    $("#infoTwitter").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoTwitter").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });


        $("#UrlVideo").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var video = $("#video").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Video: video
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zoneVideo").text(data.Video);
                    $("#infoVideo").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoVideo").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });

        $("#Post1").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var post1 = $("#post1").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Post1: post1
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zonePost1").text(data.Post1);
                    $("#infoPost1").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoPost1").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });

        $("#Post2").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var post2 = $("#post2").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Post2: post2
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zonePost2").text(data.Post2);
                    $("#infoPost2").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoPost2").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });

        $("#Post3").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var post3 = $("#post3").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Post3: post3
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zonePost3").text(data.Post3);
                    $("#infoPost3").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoPost3").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });

        $("#Name").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var nome = $("#name").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Nome: nome
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zoneName").text(data.Nome);
                    $("#infoName").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoName").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });

        $("#Surname").bind("submit", function (evt) {
            var matricola = "@MATRICOLA@";
            var cognome = $("#surname").val();
            $.ajax({
                url: "/mod_sent",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({
                    Matricola: matricola,
                    Cognome: cognome
                }),
                success: function (data, textStatus, jqXHR) {
                    $("#zoneSurname").text(data.Cognome);
                    $("#infoSurname").html("<b>Modificato!</b>");
                },
                error: function (jqXHR, textStatus,
                    errorThrown) {
                    $("#infoSurname").html(
                        "<b>Si e' verificato un errore.</b>");
                }
            });
            return false;
        });

    </script>

</body>

</html>
